apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    operatorframework.io/installed-alongside-3d62b3dfb68b7785: aap/aap-operator.v2.5.0-0.1729742145
  creationTimestamp: "2024-10-28T19:12:15Z"
  generation: 1
  labels:
    olm.managed: "true"
    operators.coreos.com/ansible-automation-platform-operator.aap: ""
  name: ansibleautomationplatforms.aap.ansible.com
  resourceVersion: "61419188"
  uid: 3715d58b-971b-4d2d-ad14-5a1a7537564b
spec:
  conversion:
    strategy: None
  group: aap.ansible.com
  names:
    kind: AnsibleAutomationPlatform
    listKind: AnsibleAutomationPlatformList
    plural: ansibleautomationplatforms
    singular: ansibleautomationplatform
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: AnsibleAutomationPlatform is the Schema for the ansibleautomationplatforms
          API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: Spec defines the desired state of AnsibleAutomationPlatform
            properties:
              admin_password_secret:
                description: Secret where the admin password can be found
                maxLength: 255
                pattern: ^[a-zA-Z0-9][-a-zA-Z0-9]{0,253}[a-zA-Z0-9]$
                type: string
              api:
                description: The gateway api deployment.
                properties:
                  log_level:
                    default: INFO
                    description: The log level for the deployment.
                    enum:
                    - DEBUG
                    - INFO
                    - WARNING
                    - ERROR
                    - CRITICAL
                    type: string
                  replicas:
                    default: 1
                    description: The number of replicas for the deployment.
                    format: int32
                    type: integer
                  resource_requirements:
                    description: Resource requirements for the galaxy api container
                    properties:
                      limits:
                        properties:
                          cpu:
                            type: string
                          memory:
                            type: string
                          storage:
                            type: string
                        type: object
                      requests:
                        properties:
                          cpu:
                            type: string
                          memory:
                            type: string
                          storage:
                            type: string
                        type: object
                    type: object
                  security_context:
                    description: Settings to apply to the securityContext field of
                      the api container.
                    type: object
                    x-kubernetes-preserve-unknown-fields: true
                  strategy:
                    description: The deployment strategy to use to replace existing
                      pods with new ones.
                    properties:
                      rollingUpdate:
                        description: 'Rolling update config params. Present only if
                          DeploymentStrategyType = RollingUpdate. --- TODO: Update
                          this to follow our convention for oneOf, whatever we decide
                          it to be.'
                        properties:
                          maxSurge:
                            anyOf:
                            - type: integer
                            - type: string
                            description: 'The maximum number of pods that can be scheduled
                              above the desired number of pods. Value can be an absolute
                              number (ex: 5) or a percentage of desired pods (ex:
                              10%). This can not be 0 if MaxUnavailable is 0. Absolute
                              number is calculated from percentage by rounding up.
                              Defaults to 25%. Example: when this is set to 30%, the
                              new ReplicaSet can be scaled up immediately when the
                              rolling update starts, such that the total number of
                              old and new pods do not exceed 130% of desired pods.
                              Once old pods have been killed, new ReplicaSet can be
                              scaled up further, ensuring that total number of pods
                              running at any time during the update is at most 130%
                              of desired pods.'
                            x-kubernetes-int-or-string: true
                          maxUnavailable:
                            anyOf:
                            - type: integer
                            - type: string
                            description: 'The maximum number of pods that can be unavailable
                              during the update. Value can be an absolute number (ex:
                              5) or a percentage of desired pods (ex: 10%). Absolute
                              number is calculated from percentage by rounding down.
                              This can not be 0 if MaxSurge is 0. Defaults to 25%.
                              Example: when this is set to 30%, the old ReplicaSet
                              can be scaled down to 70% of desired pods immediately
                              when the rolling update starts. Once new pods are ready,
                              old ReplicaSet can be scaled down further, followed
                              by scaling up the new ReplicaSet, ensuring that the
                              total number of pods available at all times during the
                              update is at least 70% of desired pods.'
                            x-kubernetes-int-or-string: true
                        type: object
                      type:
                        description: Type of deployment. Can be "Recreate" or "RollingUpdate".
                          Default is RollingUpdate.
                        type: string
                    type: object
                type: object
              bundle_cacert_secret:
                description: Secret where the trusted Certificate Authority Bundle
                  is stored
                type: string
              controller:
                description: Controller defines the desired state of AutomationController
                type: object
                x-kubernetes-preserve-unknown-fields: true
              database:
                description: The Gateway PostgreSQL database StatefulSet
                properties:
                  database_secret:
                    description: Secret where the database configuration can be found.
                      Set this to use your own external PostgreSQL database. If not
                      specified, this secret will be generated and Gateway will create
                      a managed postgres pod.
                    type: string
                  node_selector:
                    additionalProperties:
                      type: string
                    description: NodeSelector for the database pod.
                    type: object
                  postgres_data_volume_init:
                    default: false
                    description: Sets permissions on the /var/lib/pgdata/data for
                      postgres container using an init container (not Openshift)
                    type: boolean
                  postgres_extra_args:
                    description: Arguments to pass to postgres process
                    items:
                      type: string
                    type: array
                  postgres_init_container_commands:
                    description: Customize the postgres init container commands (Non
                      Openshift)
                    type: string
                  postgres_keep_pvc_after_upgrade:
                    description: Specify whether or not to keep the old PVC after
                      PostgreSQL upgrades
                    type: boolean
                  postgres_ssl_mode:
                    description: 'Configure PostgreSQL connection sslmode option.
                      Default: "prefer"'
                    type: string
                  postgres_storage_class:
                    description: Storage class to use for the PostgreSQL PVC
                    type: string
                  priority_class:
                    description: Assign a pre-existing priority class to the postgres
                      pod
                    type: string
                  resource_requirements:
                    description: Resource requirements for the database container.
                    properties:
                      claims:
                        description: "Claims lists the names of resources, defined
                          in spec.resourceClaims, that are used by this container.
                          \n This is an alpha field and requires enabling the DynamicResourceAllocation
                          feature gate. \n This field is immutable."
                        items:
                          description: ResourceClaim references one entry in PodSpec.ResourceClaims.
                          properties:
                            name:
                              description: Name must match the name of one entry in
                                pod.spec.resourceClaims of the Pod where this field
                                is used. It makes that resource available inside a
                                container.
                              type: string
                          required:
                          - name
                          type: object
                        type: array
                        x-kubernetes-list-map-keys:
                        - name
                        x-kubernetes-list-type: map
                      limits:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: 'Limits describes the maximum amount of compute
                          resources allowed. More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/'
                        type: object
                      requests:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: 'Requests describes the minimum amount of compute
                          resources required. If Requests is omitted for a container,
                          it defaults to Limits if that is explicitly specified, otherwise
                          to an implementation-defined value. More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/'
                        type: object
                    type: object
                  storage_requirements:
                    description: Storage requirements for the PostgreSQL container
                    properties:
                      limits:
                        properties:
                          storage:
                            type: string
                        type: object
                      requests:
                        properties:
                          storage:
                            type: string
                        type: object
                    type: object
                  tolerations:
                    description: Node tolerations for the database pod.
                    items:
                      description: The pod this Toleration is attached to tolerates
                        any taint that matches the triple <key,value,effect> using
                        the matching operator <operator>.
                      properties:
                        effect:
                          description: Effect indicates the taint effect to match.
                            Empty means match all taint effects. When specified, allowed
                            values are NoSchedule, PreferNoSchedule and NoExecute.
                          type: string
                        key:
                          description: Key is the taint key that the toleration applies
                            to. Empty means match all taint keys. If the key is empty,
                            operator must be Exists; this combination means to match
                            all values and all keys.
                          type: string
                        operator:
                          description: Operator represents a key's relationship to
                            the value. Valid operators are Exists and Equal. Defaults
                            to Equal. Exists is equivalent to wildcard for value,
                            so that a pod can tolerate all taints of a particular
                            category.
                          type: string
                        tolerationSeconds:
                          description: TolerationSeconds represents the period of
                            time the toleration (which must be of effect NoExecute,
                            otherwise this field is ignored) tolerates the taint.
                            By default, it is not set, which means tolerate the taint
                            forever (do not evict). Zero and negative values will
                            be treated as 0 (evict immediately) by the system.
                          format: int64
                          type: integer
                        value:
                          description: Value is the taint value the toleration matches
                            to. If the operator is Exists, the value should be empty,
                            otherwise just a regular string.
                          type: string
                      type: object
                    type: array
                type: object
              db_fields_encryption_secret:
                description: Secret where the DB fields encryption key can be found.
                  If not specified, one will be generated.
                type: string
              eda:
                description: EDA defines the desired state of EDA
                type: object
                x-kubernetes-preserve-unknown-fields: true
              extra_settings:
                description: Environment variables to configure the application-level
                  settings
                items:
                  properties:
                    setting:
                      type: string
                    value:
                      x-kubernetes-preserve-unknown-fields: true
                  type: object
                type: array
              hostname:
                description: Override default hostname of the Ansible Automation Platform
                type: string
              hub:
                description: Hub defines the desired state of AutomationHub
                type: object
                x-kubernetes-preserve-unknown-fields: true
              image:
                description: AAP Gateway container image
                type: string
              image_proxy:
                description: AAP Gateway Proxy container image
                type: string
              image_proxy_version:
                description: AAP Gateway Proxy container image version (tag)
                type: string
              image_pull_policy:
                description: The image pull policy
                enum:
                - Always
                - always
                - Never
                - never
                - IfNotPresent
                - ifnotpresent
                type: string
              image_pull_secrets:
                description: Image pull secrets for app and database containers
                items:
                  type: string
                type: array
              image_version:
                description: AAP Gateway container image version (tag)
                type: string
              ingress_annotations:
                description: Annotations to add to the Ingress Controller
                type: string
              ingress_api_version:
                description: The Ingress API version to use
                type: string
              ingress_class_name:
                description: The name of ingress class to use instead of the cluster
                  default.
                type: string
              ingress_path:
                description: The ingress path used to reach the deployed service
                type: string
              ingress_path_type:
                description: The ingress path type for the deployed service
                type: string
              ingress_tls_secret:
                description: Secret where the Ingress TLS secret can be found
                type: string
              ingress_type:
                description: The ingress type to use to reach the deployed instance
                enum:
                - none
                - Ingress
                - ingress
                - Route
                - route
                type: string
              lightspeed:
                description: Lightspeed defines the desired state of AnsibleLightspeed
                type: object
                x-kubernetes-preserve-unknown-fields: true
              loadbalancer_port:
                description: Port to use for the loadbalancer
                type: integer
              loadbalancer_protocol:
                description: Protocol to use for the loadbalancer
                enum:
                - http
                - https
                type: string
              no_log:
                default: true
                description: Configure no_log for no_log tasks
                type: boolean
              postgres_image:
                description: Registry path to the PostgreSQL container to use
                type: string
              postgres_image_version:
                description: PostgreSQL container image version to use
                type: string
              redhat_registry:
                description: Default Redhat Container Image Registry
                type: string
              redhat_registry_ns:
                description: Default Redhat Container Image Registry Namespace
                type: string
              redis:
                description: Defines desired state of cache resources
                properties:
                  eda_redis_secret:
                    description: Secret where the EDA redis configuration can be found.
                      Set this to use your own external redis instance for EDA.
                    type: string
                  node_selector:
                    additionalProperties:
                      type: string
                    description: NodeSelector for the Gateway pods.
                    type: object
                  redis_secret:
                    description: Secret where the redis configuration can be found.
                      Set this to use your own external redis instance.
                    type: string
                  replicas:
                    description: Defines Redis Deployment replicas
                    format: int32
                    type: integer
                  resource_requirements:
                    description: Resource requirements for the Redis container
                    properties:
                      claims:
                        description: "Claims lists the names of resources, defined
                          in spec.resourceClaims, that are used by this container.
                          \n This is an alpha field and requires enabling the DynamicResourceAllocation
                          feature gate. \n This field is immutable."
                        items:
                          description: ResourceClaim references one entry in PodSpec.ResourceClaims.
                          properties:
                            name:
                              description: Name must match the name of one entry in
                                pod.spec.resourceClaims of the Pod where this field
                                is used. It makes that resource available inside a
                                container.
                              type: string
                          required:
                          - name
                          type: object
                        type: array
                        x-kubernetes-list-map-keys:
                        - name
                        x-kubernetes-list-type: map
                      limits:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: 'Limits describes the maximum amount of compute
                          resources allowed. More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/'
                        type: object
                      requests:
                        additionalProperties:
                          anyOf:
                          - type: integer
                          - type: string
                          pattern: ^(\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))(([KMGTPE]i)|[numkMGTPE]|([eE](\+|-)?(([0-9]+(\.[0-9]*)?)|(\.[0-9]+))))?$
                          x-kubernetes-int-or-string: true
                        description: 'Requests describes the minimum amount of compute
                          resources required. If Requests is omitted for a container,
                          it defaults to Limits if that is explicitly specified, otherwise
                          to an implementation-defined value. More info: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/'
                        type: object
                    type: object
                  strategy:
                    description: The deployment strategy to use to replace existing
                      pods with new ones.
                    properties:
                      rollingUpdate:
                        description: 'Rolling update config params. Present only if
                          DeploymentStrategyType = RollingUpdate. --- TODO: Update
                          this to follow our convention for oneOf, whatever we decide
                          it to be.'
                        properties:
                          maxSurge:
                            anyOf:
                            - type: integer
                            - type: string
                            description: 'The maximum number of pods that can be scheduled
                              above the desired number of pods. Value can be an absolute
                              number (ex: 5) or a percentage of desired pods (ex:
                              10%). This can not be 0 if MaxUnavailable is 0. Absolute
                              number is calculated from percentage by rounding up.
                              Defaults to 25%. Example: when this is set to 30%, the
                              new ReplicaSet can be scaled up immediately when the
                              rolling update starts, such that the total number of
                              old and new pods do not exceed 130% of desired pods.
                              Once old pods have been killed, new ReplicaSet can be
                              scaled up further, ensuring that total number of pods
                              running at any time during the update is at most 130%
                              of desired pods.'
                            x-kubernetes-int-or-string: true
                          maxUnavailable:
                            anyOf:
                            - type: integer
                            - type: string
                            description: 'The maximum number of pods that can be unavailable
                              during the update. Value can be an absolute number (ex:
                              5) or a percentage of desired pods (ex: 10%). Absolute
                              number is calculated from percentage by rounding down.
                              This can not be 0 if MaxSurge is 0. Defaults to 25%.
                              Example: when this is set to 30%, the old ReplicaSet
                              can be scaled down to 70% of desired pods immediately
                              when the rolling update starts. Once new pods are ready,
                              old ReplicaSet can be scaled down further, followed
                              by scaling up the new ReplicaSet, ensuring that the
                              total number of pods available at all times during the
                              update is at least 70% of desired pods.'
                            x-kubernetes-int-or-string: true
                        type: object
                      type:
                        description: Type of deployment. Can be "Recreate" or "RollingUpdate".
                          Default is RollingUpdate.
                        type: string
                    type: object
                  tolerations:
                    description: Node tolerations for the Gateway pods.
                    items:
                      description: The pod this Toleration is attached to tolerates
                        any taint that matches the triple <key,value,effect> using
                        the matching operator <operator>.
                      properties:
                        effect:
                          description: Effect indicates the taint effect to match.
                            Empty means match all taint effects. When specified, allowed
                            values are NoSchedule, PreferNoSchedule and NoExecute.
                          type: string
                        key:
                          description: Key is the taint key that the toleration applies
                            to. Empty means match all taint keys. If the key is empty,
                            operator must be Exists; this combination means to match
                            all values and all keys.
                          type: string
                        operator:
                          description: Operator represents a key's relationship to
                            the value. Valid operators are Exists and Equal. Defaults
                            to Equal. Exists is equivalent to wildcard for value,
                            so that a pod can tolerate all taints of a particular
                            category.
                          type: string
                        tolerationSeconds:
                          description: TolerationSeconds represents the period of
                            time the toleration (which must be of effect NoExecute,
                            otherwise this field is ignored) tolerates the taint.
                            By default, it is not set, which means tolerate the taint
                            forever (do not evict). Zero and negative values will
                            be treated as 0 (evict immediately) by the system.
                          format: int64
                          type: integer
                        value:
                          description: Value is the taint value the toleration matches
                            to. If the operator is Exists, the value should be empty,
                            otherwise just a regular string.
                          type: string
                      type: object
                    type: array
                type: object
              redis_image:
                description: Registry path to the redis container to use
                type: string
              redis_image_version:
                description: Redis container image version to use
                type: string
              redis_mode:
                default: standalone
                description: Redis Mode
                enum:
                - cluster
                - standalone
                type: string
              route_api_version:
                description: The route API version to use
                type: string
              route_host:
                description: The DNS to use to points to the instance
                type: string
              route_tls_secret:
                description: Secret where the TLS related credentials are stored
                type: string
              route_tls_termination_mechanism:
                default: Edge
                description: The secure TLS termination mechanism to use
                enum:
                - Edge
                - edge
                - Passthrough
                - passthrough
                type: string
              service_account_annotations:
                description: ServiceAccount annotations
                type: string
              service_annotations:
                description: Annotations to add to the load balancer service
                type: string
              service_type:
                description: The service type to be used on the deployed instance
                enum:
                - LoadBalancer
                - loadbalancer
                - ClusterIP
                - clusterip
                - NodePort
                - nodeport
                type: string
            type: object
          status:
            description: Status defines the observed state of AnsibleAutomationPlatform
            properties:
              conditions:
                description: The resulting conditions when a Service Telemetry is
                  instantiated
                items:
                  properties:
                    lastTransitionTime:
                      type: string
                    message:
                      type: string
                    reason:
                      type: string
                    status:
                      type: string
                    type:
                      type: string
                  type: object
                type: array
              controllerDatabaseSecret:
                description: Controller database configuration secret
                type: string
              edaDatabaseSecret:
                description: EDA database configuration secret
                type: string
              hubDatabaseSecret:
                description: Hub database configuration secret
                type: string
              lightspeedDatabaseSecret:
                description: AnsibleLightspeed database configuration secret
                type: string
              upgradedFrom:
                description: Last gated version
                type: string
            type: object
            x-kubernetes-preserve-unknown-fields: true
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: AnsibleAutomationPlatform
    listKind: AnsibleAutomationPlatformList
    plural: ansibleautomationplatforms
    singular: ansibleautomationplatform
  conditions:
  - lastTransitionTime: "2024-10-28T19:12:15Z"
    message: no conflicts found
    reason: NoConflicts
    status: "True"
    type: NamesAccepted
  - lastTransitionTime: "2024-10-28T19:12:15Z"
    message: the initial names have been accepted
    reason: InitialNamesAccepted
    status: "True"
    type: Established
  storedVersions:
  - v1alpha1
